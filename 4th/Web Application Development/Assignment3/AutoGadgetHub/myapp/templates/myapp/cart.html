<!DOCTYPE html>
<html lang="en">

<head>
  {% load static %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shopping Cart - AutoGadget Hub</title>
  <link rel="stylesheet" href="{% static 'myapp/css/header_mainBody.css' %}" />
  <link rel="stylesheet" href="{% static 'myapp/css/cart_style.css' %}" />
  <script src="{% static 'myapp/js/menu.js' %}"></script>
</head>

<body>
  <!-- Header Section -->
  <header>
    <div>
      <img src="{% static 'myapp/images/my_logo.png' %}" alt="AutoGadget Hub Logo" />
      <h1>AutoGadget Hub</h1>
    </div>
    <nav>
      <a href="{% url 'home' %}">Home</a>
      <a href="{% url 'shop' %}">Shop</a>
      <a href="{% url 'about' %}">About</a>
      <a href="{% url 'contact' %}">Contact</a>
      <a href="{% url 'help' %}">Help❓</a>
    </nav>
    <div>
      <a href="{% url 'cart' %}">
        <img src="{% static 'myapp/images/shopping_cart.png' %}" alt="Shopping Cart" />
      </a>
      {% if user.is_authenticated %}
      <span class="welcome-msg">Welcome, {{ user.username }}!</span>
      <a href="{% url 'signout' %}" id="signout">Sign Out</a>
      {% else %}
      <!-- Sign-in and Sign-up links -->
      <a href="{% url 'signin' %}" id="signin">Sign In</a>
      <a href="{% url 'signup' %}" id="signup">Sign Up</a>
      {% endif %}
    </div>
  </header>

  <!-- Cart Section -->
  <main>
    <!-- side menu-->
    <div class="menu-trigger">
      <div class="hamburger">☰</div>
    </div>
    <!-- Dynamic Side Menu -->
    <nav id="sideMenu" class="side-menu">
      <div class="menu-header">
        <span class="close-btn">&times;</span>
        <h3>Navigation Menu</h3>
      </div>
      <div class="menu-content">
        <a href="{% url 'terms' %}">Terms & Conditions</a>
        <a href="{% url 'shop' %}#New"> Trending</a>
        <a href="{% url 'contact' %}"> Support</a>
        <div class="setting-item">
          <span>Dark Mode</span>
          <div class="toggle-switch" id="darkModeToggle"></div>
        </div>
      </div>
    </nav>
    <div id="menuOverlay" class="overlay"></div>
    <div class="cart-container">
      <h2>Your Shopping Cart</h2>

      <!-- Cart Table -->
      <table class="cart-table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total</th>
            <th>Remove</th>
          </tr>
        </thead>
        <tbody>
          {% for item in cart_items %}
          <tr>
            <td>
              <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="cart-image">
              {{ item.product.name }}
            </td>
            <td>€{{ item.product.price }}</td>
            <td>
              <form method="post" action="{% url 'update_cart' item.product.id %}">
                {% csrf_token %}
                <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.product.stock }}"
                  class="quantity-input">
                <input type="hidden" name="redirect_url" value="cart">
                <button type="submit" class="btn-update">Update</button>
              </form>
            </td>
            <td class="product-total">
              €{{ item.product.price|floatformat:2 }} × {{ item.quantity }} =
              €{{ item.get_total|floatformat:2 }}
            </td>
            <td>
              <a href="{% url 'remove_from_cart' item.id %}" class="remove-item"
                onclick="return confirm('Are you sure?')">Remove</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5">Your cart is empty</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- cart summary section -->
      <div class="cart-summary">
        <p><strong>Total: €{{ cart_total|floatformat:2 }}</strong></p>
        <a href="{% url 'checkout' %}">
          <button class="checkout-btn">Proceed to Checkout</button>
        </a>
      </div>
  </main>

  <!-- Footer Section -->
  <footer>
    <p>
      &copy; 2025 AutoGadget Hub. All rights reserved by Mohammed AL Shuaili
      ECE4.
    </p>
  </footer>
</body>

</html>